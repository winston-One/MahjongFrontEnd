<template>
	<view
		class="u-notice-bar"
		:style="{
			background: computeBgColor,
			padding: padding
		}"
		:class="[
			type ? `u-type-${type}-light-bg` : ''
		]"
	>
		<view class="u-icon-wrap">
			<u-icon class="u-left-icon" v-if="volumeIcon" name="volume-fill" :size="volumeSize" :color="computeColor"></u-icon>
		</view>
		<swiper :disable-touch="disableTouch" @change="change" :autoplay="autoplay && playState == 'play'" :vertical="vertical" circular :interval="duration" class="u-swiper">
			<swiper-item v-for="(item, index) in list" :key="index" class="u-swiper-item">
				<view
					class="u-news-item u-line-1"
					:style="[textStyle]"
					@tap="click(index)"
					:class="['u-type-' + type]"
				>
				<view>
					{{ item.content }}
				</view>
				<view style="position: absolute;right: 6rpx;">
					{{item.browsenum}}äººå›´è§‚ğŸ”¥
				</view>
				</view>
			</swiper-item>
		</swiper>
		<view class="u-icon-wrap">
			<u-icon @click="getMore" class="u-right-icon" v-if="moreIcon" name="arrow-right" :size="26" :color="computeColor"></u-icon>
			<u-icon @click="close" class="u-right-icon" v-if="closeIcon" name="close" :size="24" :color="computeColor"></u-icon>
		</view>
	</view>
</template>

<script>
export default {
	props: {
		// æ˜¾ç¤ºçš„å†…å®¹ï¼Œæ•°ç»„
		list: {
			type: Array,
			default() {
				return [];
			}
		},
		// æ˜¾ç¤ºçš„ä¸»é¢˜ï¼Œsuccess|error|primary|info|warning
		type: {
			type: String,
			default: 'warning'
		},
		// æ˜¯å¦æ˜¾ç¤ºå·¦ä¾§çš„éŸ³é‡å›¾æ ‡
		volumeIcon: {
			type: Boolean,
			default: true
		},
		// æ˜¯å¦æ˜¾ç¤ºå³ä¾§çš„å³ç®­å¤´å›¾æ ‡
		moreIcon: {
			type: Boolean,
			default: false
		},
		// æ˜¯å¦æ˜¾ç¤ºå³ä¾§çš„å…³é—­å›¾æ ‡
		closeIcon: {
			type: Boolean,
			default: false
		},
		// æ˜¯å¦è‡ªåŠ¨æ’­æ”¾
		autoplay: {
			type: Boolean,
			default: true
		},
		// æ–‡å­—é¢œè‰²ï¼Œå„å›¾æ ‡ä¹Ÿä¼šä½¿ç”¨æ–‡å­—é¢œè‰²
		color: {
			type: String,
			default: ''
		},
		// èƒŒæ™¯é¢œè‰²
		bgColor: {
			type: String,
			default: ''
		},
		// æ»šåŠ¨æ–¹å‘ï¼Œrow-æ°´å¹³æ»šåŠ¨ï¼Œcolumn-å‚ç›´æ»šåŠ¨
		direction: {
			type: String,
			default: 'row'
		},
		// æ˜¯å¦æ˜¾ç¤º
		show: {
			type: Boolean,
			default: true
		},
		// å­—ä½“å¤§å°ï¼Œå•ä½rpx
		fontSize: {
			type: [Number, String],
			default: 26
		},
		// æ»šåŠ¨ä¸€ä¸ªå‘¨æœŸçš„æ—¶é—´é•¿ï¼Œå•ä½ms
		duration: {
			type: [Number, String],
			default: 2000
		},
		// éŸ³é‡å–‡å­çš„å¤§å°
		volumeSize: {
			type: [Number, String],
			default: 34
		},
		// æ°´å¹³æ»šåŠ¨æ—¶çš„æ»šåŠ¨é€Ÿåº¦ï¼Œå³æ¯ç§’æ»šåŠ¨å¤šå°‘rpxï¼Œè¿™æœ‰åˆ©äºæ§åˆ¶æ–‡å­—æ— è®ºå¤šå°‘æ—¶ï¼Œéƒ½èƒ½æœ‰ä¸€ä¸ªæ’å®šçš„é€Ÿåº¦
		speed: {
			type: Number,
			default: 160
		},
		// æ°´å¹³æ»šåŠ¨æ—¶ï¼Œæ˜¯å¦é‡‡ç”¨è¡”æ¥å½¢å¼æ»šåŠ¨
		isCircular: {
			type: Boolean,
			default: true
		},
		// æ»šåŠ¨æ–¹å‘ï¼Œhorizontal-æ°´å¹³æ»šåŠ¨ï¼Œvertical-å‚ç›´æ»šåŠ¨
		mode: {
			type: String,
			default: 'horizontal'
		},
		// æ’­æ”¾çŠ¶æ€ï¼Œplay-æ’­æ”¾ï¼Œpaused-æš‚åœ
		playState: {
			type: String,
			default: 'play'
		},
		// æ˜¯å¦ç¦æ­¢ç”¨æ‰‹æ»‘åŠ¨åˆ‡æ¢
		// ç›®å‰HX2.6.11ï¼Œåªæ”¯æŒApp 2.5.5+ã€H5 2.5.5+ã€æ”¯ä»˜å®å°ç¨‹åºã€å­—èŠ‚è·³åŠ¨å°ç¨‹åº
		disableTouch: {
			type: Boolean,
			default: true
		},
		// é€šçŸ¥çš„è¾¹è·
		padding: {
			type: [Number, String],
			default: '18rpx 24rpx'
		}
	},
	computed: {
		// è®¡ç®—å­—ä½“é¢œè‰²ï¼Œå¦‚æœæ²¡æœ‰è‡ªå®šä¹‰çš„ï¼Œå°±ç”¨uviewä¸»é¢˜é¢œè‰²
		computeColor() {
			if (this.color) return this.color;
			// å¦‚æœæ˜¯æ— ä¸»é¢˜ï¼Œå°±é»˜è®¤ä½¿ç”¨content-color
			else if(this.type == 'none') return '#606266';
			else return this.type;
		},
		// æ–‡å­—å†…å®¹çš„æ ·å¼
		textStyle() {
			let style = {};
			if (this.color) style.color = this.color;
			else if(this.type == 'none') style.color = '#606266';
			style.fontSize = this.fontSize + 'rpx';
			return style;
		},
		// å‚ç›´æˆ–è€…æ°´å¹³æ»šåŠ¨
		vertical() {
			if(this.mode == 'horizontal') return false;
			else return true;
		},
		// è®¡ç®—èƒŒæ™¯é¢œè‰²
		computeBgColor() {
			if (this.bgColor) return this.bgColor;
			else if(this.type == 'none') return 'transparent';
		}
	},
	data() {
		return {
			// animation: false
		};
	},
	methods: {
		// ç‚¹å‡»é€šå‘Šæ 
		click(index) {
			this.$emit('click', index);
		},
		// ç‚¹å‡»å…³é—­æŒ‰é’®
		close() {
			this.$emit('close');
		},
		// ç‚¹å‡»æ›´å¤šç®­å¤´æŒ‰é’®
		getMore() {
			this.$emit('getMore');
		},
		change(e) {
			let index = e.detail.current;
			if(index == this.list.length - 1) {
				this.$emit('end');
			}
		}
	}
};
</script>

<style lang="scss" scoped>
@import "../../libs/css/style.components.scss";

.u-notice-bar {
	width: 100%;
	@include vue-flex;
	align-items: center;
	justify-content: center;
	flex-wrap: nowrap;
	padding: 18rpx 24rpx;
	overflow: hidden;
	height: 85rpx;
	line-height: 85rpx;
}

.u-swiper {
	font-size: 26rpx;
	height: 32rpx;
	@include vue-flex;
	align-items: center;
	flex: 1;
	margin-left: 12rpx;
}

.u-swiper-item {
	@include vue-flex;
	align-items: center;
	overflow: hidden;
}

.u-news-item {
	overflow: hidden;
	display: flex;
	justify-content: space-between;
}

.u-right-icon {
	margin-left: 12rpx;
	/* #ifndef APP-NVUE */
	display: inline-flex;		
	/* #endif */
	align-items: center;
}

.u-left-icon {
	/* #ifndef APP-NVUE */
	display: inline-flex;		
	/* #endif */
	align-items: center;
}
</style>
